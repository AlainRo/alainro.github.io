<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Animated Horizontal Bar Chart</title>
        <link type="text/css" rel="stylesheet" href="appbase.css">
        <link type="text/css" rel="stylesheet" href="wikistyle.css">
<script src="http://perceptible.fr/files/protovis-r32.js" type="text/javascript"> </script>
    </head>
    <body class="wikidpad">
<span class="wikidpad parent-nodes">parent nodes: <span class="wikidpad parent-node"><a href="Protovis.html" class="wikidpad">Protovis</a></span><br class="wikidpad" /><br class="wikidpad" /></span>
<a name=".h0"></a><h2 class="heading-level2">Animated Horizontal Bar Chart</h2>
<script type="text/javascript+protovis">

var data = [
	{"Date":"Midnight","barData":18}, 	{"Date":1,"barData":32},
	{"Date":2,"barData":17},
	{"Date":3,"barData":3},
	{"Date":4,"barData":2},
	{"Date":5,"barData":7},
	{"Date":6,"barData":13},
	{"Date":7,"barData":41},
	{"Date":8,"barData":89},
	{"Date":9,"barData":76},
	{"Date":10,"barData":59},
	{"Date":11,"barData":43},
	{"Date":"Noon","barData":68},
	{"Date":13,"barData":69},
	{"Date":14,"barData":75},
	{"Date":15,"barData":72},
	{"Date":16,"barData":83},
	{"Date":17,"barData":81},
	{"Date":18,"barData":108},
	{"Date":19,"barData":60},
	{"Date":20,"barData":38},
	{"Date":21,"barData":41},
	{"Date":22,"barData":37},
	{"Date":23,"barData":39}  	];
	


var w = 300, 	h = 400, 	topMargin = 15, 	bottomMargin = 15,
	leftMargin = 40,
	rightMargin = 30,
	gap = 3, 	baseColor = "#a7b6c1", 	highlightColor = "#a14538",
	tickLineColor = "#d6d8da",
	dataRange = 120, 	increments = 20, 	dataText = "bold 8pt Arial,sans-serif", 	tickText = "bold 6pt Arial,sans-serif",
	dateText = "7pt Arial,sans-serif"; 

	

var chartWidth = w-leftMargin-rightMargin,
	chartHeight = h-topMargin-bottomMargin,
 	yScale = pv.Scale.linear(0, data.length).range(0, chartHeight),
	total = pv.Scale.linear(0, dataRange).range(0, chartWidth),
	barWidth = chartHeight/data.length,
	commas = pv.Format.number(),	
	activeBar = -1;	
	
	
var vis = new pv.Panel().width(w).height(h)
	.event("mousemove", pv.Behavior.point(Infinity).collapse("x"));
	
	
   	vis.add(pv.Rule)
		.data(pv.range(0, dataRange, increments))
		.left(function(d) (dataRange > chartWidth) ? (d / (dataRange/chartWidth)) + leftMargin : (d * (chartWidth)/dataRange) + leftMargin)
		.top(topMargin)
		.bottom(bottomMargin)
		.strokeStyle(tickLineColor)
		.add(pv.Label)
		.textAlign("center")
		.textBaseline("bottom")
		.font(tickText)
		.textStyle("gray");
	 		  
	
	vis.add(pv.Bar)                         
		.data(data)
		.top(function() 1 + yScale(this.index)+topMargin)         
		.width(function(d) total(d.barData))  
		.height(barWidth-gap)                          
		.left(leftMargin)
		.lineWidth(.2)
		.strokeStyle("333")
		.event("point", function() {activeBar = this.index; return vis;})
		.fillStyle(function() (activeBar == this.index) ? highlightColor : baseColor) 
		.anchor("right")
		.add(pv.Label)
		.textAlign("left")
		.text(function(d) d.barData)
		.font(dataText)
		.textStyle(function() (activeBar == this.index) ? "black" : "transparent");

	   
	vis.add(pv.Bar)
		.data(data) 
		.top(function() 1 + yScale(this.index) + topMargin) 
		.left(leftMargin)
		.height(barWidth-gap)
		.fillStyle(null)
		.anchor("left")                 
		.add(pv.Label)                                     
		.text(function(d) d.Date)
		.textAlign("right")
		.font(dateText)
		.textStyle("#333333"); 
					
	
	vis.add(pv.Panel)
		.events("all") 
		.event("point", function() {activeBar = this.index; return vis;});
	 
	vis.render();
</script>    </body>
</html>
