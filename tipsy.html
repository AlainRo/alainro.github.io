<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>tipsy</title>
        <link type="text/css" rel="stylesheet" href="appbase.css">
        <link type="text/css" rel="stylesheet" href="wikistyle.css">
<script src="http://perceptible.fr/files/protovis-r32.js" type="text/javascript"> </script>
    </head>
    <body class="wikidpad">
<span class="wikidpad parent-nodes">parent nodes: <span class="wikidpad parent-node"><a href="Protovis.html" class="wikidpad">Protovis</a></span><br class="wikidpad" /><br class="wikidpad" /></span>
<script type="text/javascript+protovis">
pv.Behavior.tipsy = function(opts) {
  var tip;

  /**
   * @private When the mouse leaves the root panel, trigger a mouseleave event
   * on the tooltip span. This is necessary for dimensionless marks (e.g.,
   * lines) when the mouse isn't actually over the span.
   */
  function trigger() {
    $(tip).tipsy("hide");
  }

  /**
   * @private When the mouse leaves the tooltip, remove the tooltip span. This
   * event handler is declared outside of the event handler such that duplicate
   * registrations are ignored.
   */
  function cleanup() {
    if (tip) {
      tip.parentNode.removeChild(tip);
      tip = null;
    }
  }

  return function(d) {
      
      var t = pv.Transform.identity, p = this.parent;
      do {
        t = t.translate(p.left(), p.top()).times(p.transform());
      } while (p = p.parent);

      
      if (!tip) {
        var c = this.root.canvas();
        c.style.position = "relative";
        $(c).mouseleave(trigger);

        tip = c.appendChild(document.createElement("div"));
        tip.style.position = "absolute";
        $(tip).tipsy(opts);
      }

      
      tip.title = this.title() || this.text();

      /*
       * Compute bounding box. TODO support area, lines, wedges, stroke. Also
       * note that CSS positioning does not support subpixels, and the current
       * rounding implementation can be off by one pixel.
       */
      if (this.properties.width) {
        tip.style.width = Math.ceil(this.width() * t.k) + 1 + "px";
        tip.style.height = Math.ceil(this.height() * t.k) + 1 + "px";
      } else if (this.properties.radius) {
        var r = this.radius();
        t.x -= r;
        t.y -= r;
        tip.style.height = tip.style.width = Math.ceil(2 * r * t.k) + "px";
      }
      tip.style.left = Math.floor(this.left() * t.k + t.x) + "px";
      tip.style.top = Math.floor(this.top() * t.k + t.y) + "px";

      /*
       * Cleanup the tooltip span on mouseout. Immediately trigger the tooltip;
       * this is necessary for dimensionless marks.
       */
      $(tip).mouseleave(cleanup).tipsy("show");
    };
};
</script><br />
<br />
    </body>
</html>
